# 구성요소/메서드/라이브러리/모듈 역할 정리

CODEX.md에 등장한 스택별 핵심 구성요소의 역할과, 예시 코드 속 함수·메서드 의미를 간결히 정리했습니다. 실제 변경 포인트와 연관된 파라미터도 함께 표시합니다.

## 공통 라이브러리

- `torch` / `torchvision`
  - PyTorch 학습/추론 프레임워크, 데이터 변환(`transforms`), 모델 백본(`resnet`, `convnext` 등)
  - 중요 파라미터: `batch_size`, `num_workers`, `pin_memory`, `device`(cpu/cuda)
- `timm`
  - 다양한 SOTA 백본 구현집. 분류·특징추출 등에서 백본 교체 용이
- `transformers`
  - 허깅페이스 모델/토크나이저/파이프라인 로딩. VLM, Grounding DINO 등 고수준 API 제공
- `pillow(PIL)`
  - 이미지 로딩/저장/기본 조작
- `albumentations`
  - 강력한 이미지 증강 라이브러리. 분류/탐지/세그멘테이션 지원
- `wandb` / `tensorboard`
  - 실험 로깅/대시보드. 파라미터/지표/이미지 시각화 추적

## 캡셔닝 (BLIP 계열)

- `BlipProcessor`
  - 이미지 전처리(리사이즈/정규화) + 텍스트 디코딩 유틸 묶음
  - 교체/영향: 전처리 크기/정규화 변경 시 캡션 품질·속도 영향
- `BlipForConditionalGeneration`
  - 이미지 → 텍스트 생성을 위한 조건부 생성 모델
  - 주요 메서드: `generate(**inputs, max_new_tokens=...)`
    - `max_new_tokens`: 생성 길이 상한. 길수록 서술 풍부하나 반복/지연 증가 가능
    - `num_beams`, `top_k`, `top_p`, `temperature`: 탐색/샘플링 전략으로 다양성/정확도/일관성 균형 조정
- 모델 카드(가중치)
  - `Salesforce/blip-image-captioning-base/large`, `blip-2` 라인업
  - 교체/영향: 파라미터 수↑ → 품질↑·지연/메모리↑

## 객체 탐지 (YOLOv8)

- `ultralytics.YOLO`
  - 가중치(`.pt`) 로딩 및 추론/학습 지원 클래스
  - 주요 인자: `conf`(신뢰도 임계값), `iou`(NMS 임계값), `imgsz`(입력 해상도)
  - 결과(`results[0]`): `boxes`(좌표/클래스/점수), `names`(클래스명 매핑)
- 가중치 스케일
  - `n/s/m/l/x`: 경량↔대형. 속도-정확도 트레이드오프

## 텍스트 기반 탐지 (Grounding DINO)

- `transformers.pipeline(model="IDEA-Research/grounding-dino-base")`
  - 텍스트 프롬프트와 이미지 입력을 받아 박스/라벨/점수 반환
  - 프롬프트 설계가 성능의 핵심. 키워드 확장, 문맥 구체화, 다국어 실험 가능
- SAM(Segment Anything, 추가 결합)
  - DINO 박스를 초기 힌트로 정밀 마스크 추출. 후처리 품질 향상

## 이상/결함 탐지 (anomalib - PatchCore)

- `anomalib.data.MVTecAD`
  - 공개 벤치마크 데이터셋 로더. `category`로 품목 선택
- `anomalib.models.Patchcore`
  - 정상 샘플 특징 메모리 뱅크 기반 비지도 이상 탐지
  - 주요 구성: 특징 추출 백본, 피처 레이어 선택, 메모리 샘플링, 스코어링/임계값 추정
  - 교체/영향: 백본/레이어/메모리 크기 변경 시 AUROC/속도/메모리 소비가 변함

## 코어 스킬 모듈

- `torch.utils.data.Dataset/DataLoader`
  - 사용자 데이터 파이프라인 구현의 핵심. 반복가능/병렬 로딩/배치 구성
- `torchvision.transforms`
  - 정규화/리사이즈/크롭/증강. 입력 분포 안정화 및 일반화 향상
- 평가 지표
  - 캡셔닝: BLEU, CIDEr, METEOR(언급은 없으나 실전 고려)
  - 탐지: mAP@.5:.95, Precision/Recall
  - 이상탐지: AUROC, F1, PRO

