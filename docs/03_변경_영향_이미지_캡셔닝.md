# 변경 영향 분석: 이미지 캡셔닝

BLIP 계열 캡셔닝 파이프라인에서 “어떤 부분을 어떻게 바꾸면 결과가 어떻게 달라지는지”를 구체 예시와 함께 설명합니다.

## 모델/가중치 선택

- 변경: `base` → `large` 또는 `blip-2`
- 영향: 표현력·세부 묘사·장면 이해 향상 가능. 지연시간/VRAM 사용량 증가. 배치 크기 축소 필요
- 권장: 데모/제출 환경은 `base`, 오프라인 생성/사전연구는 `large/blip-2`

## 입력 전처리/해상도

- 변경: 입력 이미지 해상도 확대/리사이즈 정책 변경
- 영향: 작은 객체·텍스트 디테일 포착력↑, 그러나 증가한 해상도만큼 속도↓, 일부 모델은 내장 리사이즈 규약을 가짐
- 권장: 원본이 고해상도면 추론 전 `shorter-side=512~768` 수준으로 제한 후 실험

## 디코딩 전략(generate)

- 변경 포인트
  - `max_new_tokens`: 캡션 길이 상한(너무 크면 반복/장황, 작으면 정보 부족)
  - `num_beams`(빔서치): 탐색 폭↑ → 일관성↑·속도↓
  - `top_k/top_p/temperature`(샘플링): 다양성↑ ↔ 안정성↓
- 영향: 문장 길이, 다양성, 반복/환각 빈도, 지연시간이 함께 변함
- 권장: 대회 베이스라인은 `max_new_tokens=20~32`, `num_beams=3~5`, `temperature=0.7~1.0`

## 프롬프트/컨텍스트(Instruction형 모델)

- 변경: InstructBLIP/BLIP-2-OPT 등에서 “지시문 프롬프트” 추가
- 영향: 답변 스타일 통제(한글 문장화, 요약형/묘사형 선택), 오탈자/불필요한 접속사 감소
- 예시: "사진의 핵심 내용을 한 문장으로 한국어로 설명해줘"

## 후처리: 번역·문장화

- 변경: 영문→한글 번역기(NLLB/Papago/DeepL) + 규칙기반 정제
- 영향: 한국어 자연스러움 크게 향상, 고유명사/수치 왜곡 위험
- 권장: 캡션→번역→형태소 기반 간단 규칙(중복 조사 제거, 문장부호 교정)

## Fine-tuning vs Zero-shot

- 변경: 한글 캡셔닝 코퍼스 또는 Ko-LLaVA/KoBLIP 파인튜닝
- 영향: 도메인 적합도↑, 한국어 문장 품질↑, 비용/시간↑
- 권장: 제한된 시간엔 영문→번역 파이프라인, 장기 과제는 한글 파인튜닝 고려

## 성능/속도 트레이드오프 체크리스트

- VRAM 한계 → `base`/저해상도/작은 배치로 타협
- 품질 부족 → `num_beams`↑, `max_new_tokens`↑, 더 큰 가중치로
- 반복/장황 → `max_new_tokens`↓, `repetition_penalty` 적용
- 한국어 어색 → 번역기 교체, 지시문 프롬프트 개선, 한글 데이터로 미세조정

